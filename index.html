<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>CEDO RS</title>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.12/handlebars.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        Handlebars.registerHelper('toLowerCase', function(str) {
            return str.toLowerCase();
        });

        function sortResults(arr, prop, asc) {
            arr = arr.sort(function(a, b) { 
                if (asc) {
                    if (a[prop] > b[prop]) return 1;
                    if (a[prop] < b[prop]) return -1;
                    return 0;
                } else {
                    if (b[prop] > a[prop]) return 1;
                    if (b[prop] < a[prop]) return -1;
                    return 0;
                }
            });
            return arr;
        }

        $(document).ready(function() {
            $.getJSON('https://api.sheety.co/9dc03903-6ddb-4116-9ccd-6978675aac5b', function(data) {
                var template = Handlebars.compile($('#item-template').html())
                $('#content').html(template(sortResults(data, 'dataLimite', true)))
            })
        })
    </script>
    <script id="item-template" type="text/x-handlebars-template">
        {{#each this}}
            <div class="item-wrapper">
                <a href="{{url}}" target="_blank">
                    <div class="image-highlight">
                        <img src="img/{{toLowerCase tipo}}.png" />
                    </div>
                    <div class="item-content">
                        <div class="item-deadline">Inscrições até {{dataLimite}}</div>
                        <div class="item-title">{{titulo}}</div>
                        <div class="item-place">{{local}}</div>
                    </div>
                </a>
            </div>
        {{/each}}
    </script>
</head>
<body>
    <header id="navigation">
        <div id="logo"><a href="/"><img src="img/logo.png" /></a></div>
    </header>
    <main id="content">
        Carregando o conteúdo...
    </main>
    <footer id="site-info">
        CEDO RS - 2019
    </footer>
</body>
</html> 